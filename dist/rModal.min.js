/*! rModal - v0.5.0 - 2016-08-17
* https://github.com/SubZane/rmodal
* Copyright (c) 2016 Andreas Norman; Licensed MIT */
var rModal=function(){var a,b,c=document.documentElement.clientHeight,d={element:null,name:"",isFed:!1,ajaxdataurl:""},e={transitiontime:300,redrawOnResize:!0,logerrors:!1},f=function(b){options=n(e,b||{}),h(),document.querySelector("body").innerHTML+='<div class="rModal-overlay"></div>',a=document.querySelector(".rModal-overlay");var f=document.querySelectorAll(".rModal");o(f,function(a,b){a.addEventListener("touchmove",function(b){a.scrollHeight<=parseInt(c,10)&&b.preventDefault()})});var g=document.querySelectorAll("[data-rmodal]");o(g,function(a,b){a.addEventListener("click",function(b){if(b.preventDefault(),d.name=a.getAttribute("data-rmodal"),d.element=document.querySelector("#rModal_"+d.name),d.element.hasAttribute("data-modaldata")?(d.isFed=!0,d.ajaxdataurl=d.element.getAttribute("data-modaldata")):d.isFed=!1,"click touchmove touchend touchleave touchcancel".split(" ").forEach(function(a){d.element.addEventListener(a,function(a){a.target===this&&m()})}),options.redrawOnResize===!0){var c;clearTimeout(c),c=setTimeout(j,100)}window.addEventListener("orientationchange",function(){k()}),l()})})},g=function(){var a=document.body.scrollHeight,b=document.documentElement.clientHeight,c=a>b;return c},h=function(){var a=document.createElement("div");a.style.visibility="hidden",a.style.width="100px",a.style.msOverflowStyle="scrollbar",document.body.appendChild(a);var c=a.offsetWidth;a.style.overflow="scroll";var d=document.createElement("div");d.style.width="100%",a.appendChild(d);var e=d.offsetWidth;a.parentNode.removeChild(a),b=c-e},i=function(){var a=new XMLHttpRequest;a.open("GET",d.ajaxdataurl,!0),a.onload=function(){if(a.status>=200&&a.status<400){var b=JSON.parse(a.response),c=b.content;d.element.querySelector(".rModal").innerHTML+='<div class="content">'+c+"</div>"}else options.logerrors&&console.log("An error occured when trying to load data from "+d.ajaxdataurl)},a.onerror=function(){options.logerrors&&console.log("A connection error occured when trying to access "+d.ajaxdataurl)},a.send()},j=function(){c=window.innerHeight,k()},k=function(){d.element.style.height=c},l=function(){k(d.name),g()===!0&&(document.querySelector("body").style.marginRight="15px"),document.querySelector("body").classList.add("rModal-locked"),document.querySelector("html").classList.add("rModal-locked"),a.classList.add("fadein"),d.isFed&&i(),d.element.classList.add("rModal-active"),d.element.querySelector(".rModal-closebutton").addEventListener("click",function(a){a.preventDefault(),m()})},m=function(){d.element.classList.add("rModal-inactive"),a.classList.add("fadeout"),setTimeout(function(){d.element.classList.remove("rModal-active"),d.element.classList.remove("rModal-inactive"),a.classList.remove("fadein"),a.classList.remove("fadeout"),document.querySelector("body").classList.remove("rModal-locked"),document.querySelector("html").classList.remove("rModal-locked"),d.isFed&&d.element.querySelector(".rModal .content").remove(),document.querySelector("body").style.marginRight=""},options.transitiontime)},n=function(a,b){var c={};return o(a,function(b,d){c[d]=a[d]}),o(b,function(a,d){c[d]=b[d]}),c},o=function(a,b,c){if("[object Object]"===Object.prototype.toString.call(a))for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&b.call(c,a[d],d,a);else for(var e=0,f=a.length;f>e;e++)b.call(c,a[e],e,a)};return{init:f}}();